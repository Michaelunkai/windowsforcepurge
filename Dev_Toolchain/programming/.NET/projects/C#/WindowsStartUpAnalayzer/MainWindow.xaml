<Window x:Class="Windows11StartupAnalyzer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Windows 11 Startup Analyzer" Height="700" Width="1200"
        WindowStartupLocation="CenterScreen" ResizeMode="CanResize">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <Border Grid.Row="0" Background="#FF0078D4" Padding="20,15">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="ðŸš€" FontSize="24" Margin="0,0,10,0"/>
                <TextBlock Text="Windows 11 Startup Performance Analyzer" 
                           FontSize="20" FontWeight="Bold" Foreground="White" VerticalAlignment="Center"/>
            </StackPanel>
        </Border>
        
        <!-- Total Startup Time Display -->
        <Border Grid.Row="1" Background="#FFF0F8FF" BorderBrush="#FFE0E0E0" BorderThickness="0,0,0,1" Padding="20,15">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="Total Startup Time: " FontSize="18" FontWeight="Bold" VerticalAlignment="Center"/>
                <TextBlock x:Name="TotalStartupTimeText" Text="Calculating..." FontSize="18" FontWeight="Bold" 
                          Foreground="#FFD83B01" VerticalAlignment="Center" Margin="10,0"/>
                <TextBlock Text="seconds" FontSize="18" VerticalAlignment="Center" Margin="5,0"/>
                <Button x:Name="RefreshButton" Content="ðŸ”„ Refresh Analysis" Margin="30,0,0,0" 
                        Click="RefreshButton_Click" Background="#FF107C10"/>
            </StackPanel>
        </Border>
        
        <!-- Main Content -->
        <TabControl Grid.Row="2" Margin="10">
            <TabItem Header="Startup Programs" FontSize="14">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <Border Grid.Row="0" Margin="10" Background="#FFF8F8F8" Padding="10">
                        <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Filter:" FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,10,0"/>
                        <ComboBox x:Name="FilterComboBox" Width="150" SelectionChanged="FilterComboBox_SelectionChanged">
                            <ComboBoxItem Content="All Items" IsSelected="True"/>
                            <ComboBoxItem Content="Slow Items (>5s)"/>
                            <ComboBoxItem Content="Medium Items (1-5s)"/>
                            <ComboBoxItem Content="Fast Items (&lt;1s)"/>
                        </ComboBox>
                            <TextBlock Text="Search:" FontWeight="Bold" VerticalAlignment="Center" Margin="20,0,10,0"/>
                            <TextBox x:Name="SearchTextBox" Width="200" TextChanged="SearchTextBox_TextChanged"/>
                        </StackPanel>
                    </Border>
                    
                    <DataGrid x:Name="StartupItemsGrid" Grid.Row="1" AutoGenerateColumns="False" 
                              CanUserAddRows="False" SelectionMode="Single" 
                              IsReadOnly="True" GridLinesVisibility="Horizontal">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Rank" Binding="{Binding Rank}" Width="60"/>
                            <DataGridTextColumn Header="Program Name" Binding="{Binding Name}" Width="200"/>
                            <DataGridTextColumn Header="Load Time (seconds)" Binding="{Binding LoadTimeSeconds, StringFormat=F2}" Width="150"/>
                            <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                            <DataGridTextColumn Header="Impact" Binding="{Binding Impact}" Width="80"/>
                            <DataGridTextColumn Header="Location" Binding="{Binding Location}" Width="300"/>
                            <DataGridTemplateColumn Header="Actions" Width="200">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <Button Content="Disable" Width="60" Height="25" Margin="2" 
                                                    Click="DisableStartupItem_Click" 
                                                    IsEnabled="{Binding CanDisable}"
                                                    Background="#FFD13438"/>
                                            <Button Content="Delay" Width="50" Height="25" Margin="2" 
                                                    Click="DelayStartupItem_Click"
                                                    IsEnabled="{Binding CanDelay}"
                                                    Background="#FFFF8C00"/>
                                            <Button Content="Info" Width="40" Height="25" Margin="2" 
                                                    Click="InfoStartupItem_Click"
                                                    Background="#FF0078D4"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>
            
            <TabItem Header="Services" FontSize="14">
                <DataGrid x:Name="ServicesGrid" AutoGenerateColumns="False" 
                          CanUserAddRows="False" SelectionMode="Single" IsReadOnly="True">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Rank" Binding="{Binding Rank}" Width="60"/>
                        <DataGridTextColumn Header="Service Name" Binding="{Binding Name}" Width="200"/>
                        <DataGridTextColumn Header="Load Time (seconds)" Binding="{Binding LoadTimeSeconds, StringFormat=F2}" Width="150"/>
                        <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                        <DataGridTextColumn Header="Startup Type" Binding="{Binding StartupType}" Width="120"/>
                        <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="300"/>
                        <DataGridTemplateColumn Header="Actions" Width="150">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <Button Content="Configure" Width="70" Height="25" Margin="2" 
                                                Click="ConfigureService_Click"
                                                Background="#FF0078D4"/>
                                        <Button Content="Info" Width="40" Height="25" Margin="2" 
                                                Click="InfoService_Click"
                                                Background="#FF107C10"/>
                                    </StackPanel>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>
            
            <TabItem Header="System Events" FontSize="14">
                <DataGrid x:Name="SystemEventsGrid" AutoGenerateColumns="False" 
                          CanUserAddRows="False" SelectionMode="Single" IsReadOnly="True">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Event Time" Binding="{Binding EventTime}" Width="150"/>
                        <DataGridTextColumn Header="Event" Binding="{Binding EventName}" Width="200"/>
                        <DataGridTextColumn Header="Duration (seconds)" Binding="{Binding Duration, StringFormat=F2}" Width="150"/>
                        <DataGridTextColumn Header="Source" Binding="{Binding Source}" Width="150"/>
                        <DataGridTextColumn Header="Details" Binding="{Binding Details}" Width="400"/>
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>
            
            <TabItem Header="Optimization Tips" FontSize="14">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel x:Name="OptimizationTipsPanel" Margin="20">
                        <TextBlock Text="Optimization Recommendations" FontSize="18" FontWeight="Bold" Margin="0,0,0,15"/>
                        <!-- Tips will be dynamically added here -->
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
        </TabControl>
        
        <!-- Status Bar -->
        <StatusBar Grid.Row="3" Background="#FFF0F0F0">
            <StatusBarItem>
                <TextBlock x:Name="StatusText" Text="Ready"/>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <TextBlock x:Name="LastUpdateText" Text="Last updated: Never"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>