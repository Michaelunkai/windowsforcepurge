$apps = @(); $apps += (Get-WinEvent -FilterHashtable @{LogName='Application'; ProviderName='Application Error'; StartTime=(Get-Date).AddDays(-30)} | Where-Object { $_.Message -match "Faulting application name: (.*\.exe)" } | ForEach-Object { $matches[1].Trim() }); if ($apps.Count -lt 30) { $apps += (Get-Process | Select-Object -ExpandProperty Name) }; $apps | Group-Object | Sort-Object -Property Count -Descending | Select-Object -First 30 Count, Name
