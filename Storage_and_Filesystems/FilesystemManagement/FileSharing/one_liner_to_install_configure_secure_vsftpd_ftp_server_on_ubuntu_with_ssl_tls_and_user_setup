sudo apt install vsftpd -y && sudo cp /etc/vsftpd.conf /etc/vsftpd.conf.bak && sudo sed -i 's/anonymous_enable=YES/anonymous_enable=NO/; s/#local_enable=YES/local_enable=YES/; s/#write_enable=YES/write_enable=YES/; s/#chroot_local_user=YES/chroot_local_user=YES/' /etc/vsftpd.conf && echo -e "pasv_min_port=40000\npasv_max_port=50000\nssl_enable=YES\nrsa_cert_file=/etc/ssl/private/vsftpd.pem\nrsa_private_key_file=/etc/ssl/private/vsftpd.pem" | sudo tee -a /etc/vsftpd.conf && sudo openssl req -x509 -nodes -days 3650 -newkey rsa:2048 -keyout /etc/ssl/private/vsftpd.pem -out /etc/ssl/private/vsftpd.pem -subj "/C=US/ST=State/L=City/O=Organization/OU=OrgUnit/CN=example.com" && sudo chmod 600 /etc/ssl/private/vsftpd.pem && sudo systemctl restart vsftpd && sudo ufw allow 20/tcp && sudo ufw allow 21/tcp && sudo ufw allow 40000:50000/tcp && sudo ufw allow 990/tcp && sudo ufw reload && sudo adduser --disabled-password --gecos "" ftpuser && sudo mkdir -p /home/ftpuser/ftp/upload && sudo chown nobody:nogroup /home/ftpuser/ftp && sudo chmod a-w /home/ftpuser/ftp && sudo chown ftpuser:ftpuser /home/ftpuser/ftp/upload && echo "ftpuser" | sudo tee -a /etc/vsftpd.userlist && sudo systemctl restart vsftpd && sudo systemctl status vsftpd
