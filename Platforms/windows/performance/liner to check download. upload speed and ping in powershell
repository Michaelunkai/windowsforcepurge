if (!(Get-Command speedtest -ErrorAction SilentlyContinue)) { Invoke-WebRequest -Uri "https://install.speedtest.net/app/cli/ookla-speedtest-1.2.0-win64.zip" -OutFile "$env:TEMP\speedtest.zip"; Expand-Archive "$env:TEMP\speedtest.zip" -DestinationPath "$env:TEMP\speedtest" -Force; $env:Path += ";$env:TEMP\speedtest" } ; & "$env:TEMP\speedtest\speedtest.exe" --accept-license --accept-gdpr -f json | ConvertFrom-Json | ForEach-Object { "Ping: $($_.ping.latency) ms`nDownload: $([math]::Round($_.download.bandwidth/125000,2)) Mbps`nUpload: $([math]::Round($_.upload.bandwidth/125000,2)) Mbps" }
