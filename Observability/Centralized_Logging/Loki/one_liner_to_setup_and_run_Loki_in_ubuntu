sudo apt-get update && sudo apt-get install -y curl unzip && uname -a && curl -O -L "https://github.com/grafana/loki/releases/download/v2.4.1/loki-linux-amd64.zip" && unzip "loki-linux-amd64.zip" && chmod a+x "loki-linux-amd64" && sudo cp loki-linux-amd64 /usr/local/bin/loki && loki --version && sudo useradd --system loki && sudo mkdir -p /etc/loki /etc/loki/logs && sudo curl -o /etc/loki/loki-local-config.yaml -L "https://gist.github.com/psujit775/ceaf475fc369e25a2d04501f8a7c0a59/raw" && sudo chown -R loki: /etc/loki && echo -e "[Unit]\nDescription=Loki service\nAfter=network.target\n\n[Service]\nType=simple\nUser=loki\nExecStart=/usr/local/bin/loki -config.file /etc/loki/loki-local-config.yaml\nRestart=on-failure\nRestartSec=20\nStandardOutput=append:/etc/loki/logs/loki.log\nStandardError=append:/etc/loki/logs/loki.log\n\n[Install]\nWantedBy=multi-user.target" | sudo tee /etc/systemd/system/loki.service > /dev/null && sudo systemctl daemon-reload && sudo systemctl start loki && sudo systemctl status loki && sudo systemctl enable loki.service && echo "Loki is successfully installed and running. You can check metrics at: http://localhost:3100/metrics"
