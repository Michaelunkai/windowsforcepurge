# One-liner to setup and run QwenCode in PowerShell\r\n# This script will:\r\n# 1. Install Node.js (if not already installed) using the official method.\r\n# 2. Install the QwenCode CLI globally using npm.\r\n# 3. Run the QwenCode CLI.\r\n\r\n# Note: Requires PowerShell 5.1 or later for compatibility with Invoke-WebRequest and .NET methods.\r\n\r\n# Function to check if a command exists\r\nfunction Test-CommandExists {\r\n    param (\r\n        [string]$Command\r\n    )\r\n    $oldPreference = $ErrorActionPreference\r\n    $ErrorActionPreference = 'stop'\r\n    try {\r\n        if (Get-Command $Command -ErrorAction Stop) {\r\n            return $true\r\n        }\r\n    }\r\n    catch {\r\n        return $false\r\n    }\r\n    finally {\r\n        $ErrorActionPreference = $oldPreference\r\n    }\r\n}\r\n\r\n# Check if Node.js is installed\r\nif (-not (Test-CommandExists \"node\")) {\r\n    Write-Host \"Node.js not found. Installing...\"\r\n    # Download and install Node.js (LTS version) using the Windows installer.\r\n    # This part is a bit tricky in a one-liner, as it involves downloading an .msi.\r\n    # We'll use the Node.js Windows installer method.\r\n    # This downloads the latest LTS version (x64) installer.\r\n\r\n    $nodeInstallerUrl = \"https://nodejs.org/dist/latest-v20.x/node-v20.x-x64.msi\" # Example LTS version\r\n    $installerPath = \"$env:TEMP\\nodejs.msi\"\r\n    \r\n    Write-Host \"Downloading Node.js installer from $nodeInstallerUrl...\"\r\n    Invoke-WebRequest -Uri $nodeInstallerUrl -OutFile $installerPath\r\n    \r\n    Write-Host \"Installing Node.js...\"\r\n    # Silent install\r\n    Start-Process msiexec.exe -Wait -ArgumentList \"/i `\"$installerPath`\" /quiet /norestart\"\r\n    \r\n    # Clean up\r\n    Remove-Item -Path $installerPath -Force\r\n    \r\n    # Refresh environment variables for the session\r\n    $env:Path = [System.Environment]::GetEnvironmentVariable(\"Path\",\"Machine\") + \";\" + [System.Environment]::GetEnvironmentVariable(\"Path\",\"User\")\r\n    \r\n    Write-Host \"Node.js installed.\"\r\n} else {\r\n    Write-Host \"Node.js is already installed.\"\r\n}\r\n\r\n# Check if npm is available after Node.js install\r\nif (-not (Test-CommandExists \"npm\")) {\r\n    Write-Error \"npm command not found after Node.js installation. Please check your PATH.\"\r\n    exit 1\r\n}\r\n\r\n# Install QwenCode CLI globally\r\nWrite-Host \"Installing QwenCode CLI...\"\r\nnpm install -g @qwen-code/qwen-code@latest\r\n\r\n# Run QwenCode\r\nWrite-Host \"Starting QwenCode...\"\r\nqwen\r\n