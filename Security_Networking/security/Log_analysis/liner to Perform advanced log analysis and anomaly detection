sudo apt install -y logwatch && logwatch --detail High --range All --format text > logwatch_report.txt && grep -E "Failed password|Invalid user" /var/log/auth.log | awk '{print $9}' | sort | uniq -c | sort -nr > failed_logins.txt && python3 -c "import pandas as pd; from sklearn.ensemble import IsolationForest; df = pd.read_csv('failed_logins.txt', sep=' ', names=['count', 'ip']); model = IsolationForest(contamination=0.1); df['anomaly'] = model.fit_predict(df[['count']]); print(df[df['anomaly'] == -1])" > anomalies.txt && echo "Log analysis completed. Check logwatch_report.txt, failed_logins.txt, and anomalies.txt for results."
